# Docling Document Ingestion Configuration
# This configures document processing and chunking

apiVersion: v1
kind: ConfigMap
metadata:
  name: docling-config
  namespace: default  # Update with your namespace
data:
  config.yaml: |
    # Docling Configuration
    ingestion:
      # Supported file formats
      supportedFormats:
        - pdf
        - docx
        - txt
        - md
        - html
      
      # File size limits
      maxFileSize: 100MB
      maxPages: 1000
      
      # Processing options
      processing:
        ocr:
          enabled: true
          language: auto  # Auto-detect language
          engine: tesseract  # OCR engine
        tableExtraction:
          enabled: true
          format: markdown  # Table output format
        imageExtraction:
          enabled: true
          format: base64
      
      # Chunking configuration
      chunking:
        strategy: semantic  # Options: semantic, fixed, sliding
        chunkSize: 512  # Tokens per chunk
        chunkOverlap: 50  # Overlap between chunks
        minChunkSize: 100  # Minimum chunk size
        maxChunkSize: 1024  # Maximum chunk size
      
      # Metadata extraction
      metadata:
        extractTitle: true
        extractAuthor: true
        extractDate: true
        extractKeywords: true
        customFields: []
      
      # Output format
      output:
        format: json  # Options: json, jsonl, parquet
        includeRawText: true
        includeEmbeddings: false  # Embeddings handled separately

---
# Deployment for Docling service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: docling-service
  namespace: default  # Update with your namespace
spec:
  replicas: 2
  selector:
    matchLabels:
      app: docling
  template:
    metadata:
      labels:
        app: docling
    spec:
      containers:
      - name: docling
        image: <docling-image>  # Update with Docling image
        ports:
        - containerPort: 8080
        env:
        - name: CONFIG_PATH
          value: /etc/docling/config.yaml
        volumeMounts:
        - name: config
          mountPath: /etc/docling
        resources:
          requests:
            memory: "2Gi"
            cpu: "1"
          limits:
            memory: "4Gi"
            cpu: "2"
      volumes:
      - name: config
        configMap:
          name: docling-config

---
# Service for Docling
apiVersion: v1
kind: Service
metadata:
  name: docling-service
  namespace: default  # Update with your namespace
spec:
  selector:
    app: docling
  ports:
    - name: http
      port: 8080
      targetPort: 8080
      protocol: TCP
  type: ClusterIP

